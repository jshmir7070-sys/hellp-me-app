/**
 * HellpMe 앱 계약서 콘텐츠 (법적 방어 강화 버전 v2.0)
 *
 * 1. HELPER_CONTRACT_TERMS: 헬퍼 ↔ 본사 화물운송위탁계약 (가입 시 1회)
 * 2. REQUESTER_ORDER_CONTRACT_TERMS: 요청자 ↔ 본사 오더등록 계약 (오더 등록시마다)
 *
 * 법적 근거:
 *   - 화물자동차 운수사업법 및 동법 시행령 (2025.12.02. 법률 제21190호)
 *   - 전자문서 및 전자거래 기본법 제4조, 제4조의2
 *   - 전자서명법 제3조
 *   - 약관의 규제에 관한 법률 제6조~제14조
 *   - 개인정보보호법 제15조, 제17조, 제22조
 *   - 산업재해보상보험법 제91조의15~제91조의21 (노무제공자 특례)
 *   - 상법 제46조 (상행위), 민법 제428조의2
 *   - 전자상거래 등에서의 소비자보호에 관한 법률 제3조 (B2B 적용제외)
 *
 * 사용법:
 *   - termsVersions 테이블에 content 필드로 저장
 *   - 앱 내 체크박스 동의 UI에서 각 항목별 표시 (반드시 개별 항목 열람 후 동의)
 *   - signupConsents / orderConsents 테이블에 동의 기록
 *   - 동의 시 반드시 IP, UserAgent, 동의 시각, 약관 버전 ID 기록
 *
 * 변경 이력:
 *   v1.0 (2026-02-22): 최초 작성
 *   v2.0 (2026-02-22): 법적 방어 강화 - 약관규제법 대응, 관할법원 지정,
 *                       약관변경 절차, 수수료 상한, B2B 명시, 감사추적 강화,
 *                       독립사업자 판단기준 보강, 불가항력 정의, 손해배상 상한,
 *                       분쟁해결 절차 구체화, 재위탁금지 조항 추가
 */

// ═══════════════════════════════════════════════════════════════
// 1. 헬퍼(용차기사) ↔ 본사 화물운송위탁계약서
//    - 가입 시 1회 체결
//    - termsType: "helper_contract"
// ═══════════════════════════════════════════════════════════════

export const HELPER_CONTRACT_TERMS = {
  // ── 전체 계약 개요 (표시용, 체크박스 아님) ──
  contractOverview: {
    title: '화물운송위탁 기본계약서 (헬퍼 ↔ 주식회사 헬프미)',
    content: `본 계약은 주식회사 헬프미(사업자등록번호: [사업자번호], 이하 "회사")와 화물운송 수탁자(이하 "헬퍼") 간에 HellpMe 플랫폼을 통한 화물운송위탁 업무 전반에 관하여 체결하는 기본계약입니다.

본 계약은 헬퍼 가입 시 1회 체결되며, 플랫폼을 통해 수행하는 모든 개별 오더에 대해 적용됩니다.

▪ 계약 당사자
  갑(회사): 주식회사 헬프미 (HellpMe)
  을(헬퍼): 본인 (독립 사업자 자격의 화물자동차 운송사업자/용차기사)

▪ 적용 법령
  - 화물자동차 운수사업법 및 동법 시행령·시행규칙
  - 전자문서 및 전자거래 기본법
  - 전자서명법
  - 약관의 규제에 관한 법률
  - 개인정보보호법
  - 산업재해보상보험법 (노무제공자 특례)
  - 고용보험 및 산업재해보상보험의 보험료징수 등에 관한 법률

▪ 계약서 구성
  본 계약서는 총 18개 조항으로 구성되며, 각 조항의 세부 내용을 확인한 후 개별 동의합니다.`,
  },

  // ── 필수 동의 항목 ──

  contractPurpose: {
    title: '[필수] 제1조~제3조: 계약 목적, 정의 및 효력',
    content: `제1조 (목적)
본 계약은 회사가 운영하는 HellpMe 플랫폼(이하 "플랫폼")을 통하여 화물운송 위탁자(이하 "요청자")의 화물운송 요청을 헬퍼(수탁자)가 수행함에 있어, 회사와 헬퍼 간의 권리·의무 및 기타 필요한 사항을 정하는 것을 목적으로 합니다.

제2조 (용어의 정의)
본 계약에서 사용하는 용어의 정의는 다음과 같습니다.
1. "플랫폼"이란 회사가 운영하는 HellpMe 화물운송 중개 모바일 애플리케이션 및 관련 웹 서비스를 말합니다.
2. "오더"란 요청자가 플랫폼에 등록하는 개별 화물운송 요청 건을 말합니다.
3. "계약금"이란 오더 등록 시 요청자가 선급하는 금액으로, 플랫폼 관리자가 설정한 비율(이하 "계약금율")에 따라 자동 산출됩니다. 계약금율의 현행 기본값은 10%이며, 변경 시 제16조에 따라 사전 고지됩니다.
4. "정산"이란 작업 완료 후 실제 수행 실적 기준으로 최종 금액을 확정하고, 수수료를 공제한 후 헬퍼에게 지급하는 절차를 말합니다.
5. "마감보고서"란 헬퍼가 작업 완료 후 플랫폼을 통해 제출하는 배송수량, 회수수량, 픽업수량 등의 실적 보고서를 말합니다.
6. "수수료"란 플랫폼 이용의 대가로 정산금액에서 공제되는 금액으로, 플랫폼 수수료와 팀장 인센티브로 구성됩니다.
7. "불가항력"이란 천재지변, 전쟁, 폭동, 테러, 전염병(감염병의 예방 및 관리에 관한 법률상 제1급 감염병), 정부의 명령·규제, 통신·전력의 대규모 장애 등 당사자의 합리적 통제 범위를 벗어난 사유를 말합니다.

제3조 (계약의 체결 및 효력)
1. 본 계약은 헬퍼가 플랫폼 가입 시 각 동의 항목에 대해 개별적으로 내용을 열람하고, 전자적 동의(체크박스 선택 및 전자서명)를 완료한 시점에 체결된 것으로 봅니다.
2. 전자적 동의는 전자문서 및 전자거래 기본법 제4조 및 제4조의2에 따라, 열람가능성·재현가능성·보존성 요건을 충족하는 경우 서면 계약과 동일한 법적 효력을 가집니다.
3. 전자서명법 제3조에 따라, 당사자 간 약정에 의한 전자서명은 서명·날인과 동일한 효력을 가집니다.
4. 본 계약의 유효기간은 체결일로부터 헬퍼의 플랫폼 탈퇴 시까지이며, 탈퇴 후에도 미정산 오더에 관한 조항은 정산 완료 시까지 존속합니다.
5. 회사는 동의 기록(동의 항목, 동의 시각, IP 주소, 기기 정보, 약관 버전)을 법적 증빙을 위해 5년간 보존합니다.`,
    required: true,
  },

  paymentSettlement: {
    title: '[필수] 제4조~제5조: 대금 결제 및 정산',
    content: `제4조 (계약금 및 결제 구조)
1. 요청자는 오더 등록 시 플랫폼이 산출한 계약금을 납부하여야 하며, 계약금 납부 완료 시 오더가 공개됩니다.
2. 계약금 산출 공식:
   공급가액(BOX수 × 단가) × 1.1(부가세) × 계약금율(%)
   ※ 계약금율 현행 기본값: 10% (관리자 설정에 의해 변경 가능하며, 변경 시 제16조에 따라 30일 전 사전 고지)
3. 계약금은 요청자의 오더 이행 보증금 성격으로, 정상적인 거래 완료 시 총 대금에서 차감됩니다.
4. 결제 수단은 플랫폼이 제공하는 방법(가상계좌 이체, 카드 결제 등)에 따릅니다.

제5조 (잔금 결제 및 정산)
1. 작업 완료 후 헬퍼는 플랫폼을 통해 마감보고서를 제출합니다.
2. 요청자는 마감보고서 확인 후 최종 금액을 확정하고, 잔금(총액 - 계약금)을 정해진 기한 내에 납부합니다.
3. 정산금액은 실제 수행 실적 기준으로 산출되며, 수수료 공제 후 헬퍼에게 지급됩니다.
   - 수수료 구성: 플랫폼 수수료(platformRate) + 팀장 인센티브(teamLeaderRate)
   - 수수료율 합산 상한: 최대 30%를 초과할 수 없습니다.
   - 현행 적용 수수료율은 앱 내 "수수료 정책" 페이지에서 확인할 수 있습니다.
   - 수수료율 변경 시 제16조에 따라 30일 전 사전 고지됩니다.
4. 정산 확정 후 헬퍼가 확인(confirm)하면 정산서는 잠금(lock)되어 수정이 불가합니다. 잠금된 정산서에 대한 이의제기는 제15조에 따릅니다.
5. 정산금은 헬퍼가 등록한 은행계좌로 지급되며, 정산 일정은 마감 후 익월 내 지급을 원칙으로 합니다.
6. 회사의 귀책사유로 정산이 지연되는 경우, 지연일수에 대해 연 6%의 지연이자를 가산하여 지급합니다(상법 제54조 준용).`,
    required: true,
  },

  cancellationPenalty: {
    title: '[필수] 제6조: 계약금 반환 및 위약금',
    content: `제6조 (계약금 반환 및 위약금)
1. 요청자 귀책사유에 의한 취소:
   가. 오더 매칭 전: 계약금 전액 반환 (위약금 없음)
   나. 오더 매칭 후 ~ 작업개시 24시간 전: 계약금의 90% 반환, 10%는 위약금으로 헬퍼에게 지급
   다. 작업개시 24시간 이내 ~ 작업 시작 후: 계약금 반환 불가, 헬퍼에게 발생한 실제 손해(교통비, 준비비용 등) 별도 배상

2. 헬퍼 귀책사유에 의한 취소:
   가. 오더 수락 후 ~ 작업개시 24시간 전: 플랫폼 경고 1회 부과
   나. 작업개시 24시간 이내 ~ 작업 시작 후: 요청자에게 발생한 직접 손해 배상 의무 발생
   다. 6개월 내 3회 이상 귀책 취소 시: 30일간 신규 오더 수락 제한
   라. 12개월 내 5회 이상 귀책 취소 시: 계정 정지 및 계약 해지 사유

3. 양 당사자 합의에 의한 취소: 실비(이미 발생한 플랫폼 수수료 등)를 공제한 후 반환합니다.

4. 불가항력(제2조 제7호)에 의한 취소: 양 당사자 모두 위약금 책임을 면하며, 계약금은 전액 반환됩니다. 다만, 불가항력 사유의 입증 책임은 이를 주장하는 당사자에게 있습니다.

5. 분쟁 발생 시: 해당 정산은 보류(hold)되며, 제15조의 분쟁해결 절차에 따라 처리됩니다.

6. 위약금 수준의 적정성: 본 조의 위약금은 약관의 규제에 관한 법률 제8조에 따라 고객에게 부당하게 과중한 손해배상 의무를 부담시키지 않도록 설정되었으며, 실제 손해액과 현저한 차이가 있는 경우 조정될 수 있습니다.`,
    required: true,
  },

  helperObligations: {
    title: '[필수] 제7조~제8조: 헬퍼 의무 및 운송 책임',
    content: `제7조 (헬퍼의 의무)
1. 화물자동차 운수사업법에 따른 유효한 화물운송자격증을 보유·유지하여야 합니다.
2. 오더에 명시된 일정과 장소에 맞춰 성실히 운송을 수행하여야 합니다.
3. 화물의 안전한 운송에 대한 선량한 관리자의 주의의무를 다하여야 합니다.
4. 작업 완료 후 플랫폼을 통해 마감보고서를 정확히 제출하여야 합니다.
5. 플랫폼의 작업관리 시스템(QR 체크인/아웃 등)에 성실히 참여하여야 합니다. 단, QR 체크인/아웃은 작업 현장 도착·출발 확인 및 안전관리 목적이며, 회사의 지휘·감독 수단이 아닙니다.
6. 화물자동차 운수사업법 제11조의2에 따라 위탁받은 운송을 제3자에게 재위탁하여서는 아니 됩니다.
7. 운송 중 사고 발생 시 즉시 플랫폼에 통보하고, 화물의 추가 손상 방지를 위한 합리적 조치를 취하여야 합니다.

제8조 (운송 책임 및 손해배상)
1. 헬퍼는 운송 중 발생하는 화물 파손, 분실, 훼손에 대해 상법 제135조(운송인의 책임)에 따른 책임을 집니다.
2. 손해배상 범위:
   가. 배상 범위는 화물의 실제 손해액(시가 기준)을 한도로 합니다.
   나. 요청자가 오더 등록 시 화물 가액을 신고한 경우, 신고 가액을 배상 상한으로 합니다.
   다. 화물 가액 미신고 시, 배상 상한은 해당 오더 운송대금의 3배 또는 500만원 중 적은 금액으로 합니다.
   라. 간접 손해(일실이익, 기대이익 등)는 헬퍼의 고의 또는 중대한 과실이 있는 경우에 한하여 배상합니다.
3. 헬퍼의 고의 또는 중대한 과실로 인한 확정된 손해배상액은, 헬퍼의 서면 동의를 받아 정산에서 차감할 수 있습니다.
4. 불가항력(제2조 제7호)으로 인한 손해는 양 당사자 모두 책임을 면합니다. 다만, 불가항력 사유가 소멸된 후 합리적 기간 내에 의무를 이행하여야 합니다.`,
    required: true,
  },

  independentContractor: {
    title: '[필수] 제9조: 법적 지위 및 독립 사업자 관계 확인',
    content: `제9조 (법적 지위)
본인은 다음 사항을 확인합니다.

▪ 독립 사업자로서의 관계
1. 본인과 회사 간에는 근로기준법상 근로계약 관계가 아닌, 화물자동차 운수사업법에 기반한 운송위탁 관계입니다.
2. 본인은 자기 소유 또는 임차한 화물차량을 이용하여, 독립적인 사업자로서 운송 업무를 수행합니다.
3. 회사는 본인에 대해 근로기준법상의 지휘·감독권을 행사하지 않으며, 본인은 오더의 수락·거절을 자유롭게 결정할 수 있습니다.
4. 본인은 복수의 플랫폼 또는 다른 운송 사업을 동시에 영위할 수 있으며, 회사는 이를 제한하지 않습니다.
5. 작업 수행 방식(운행 경로, 작업 순서 등)은 원칙적으로 본인의 재량에 따릅니다. 단, 요청자가 지정한 배송지 및 시간은 준수합니다.

▪ 세금 및 보험
1. 본인의 소득은 소득세법에 따른 사업소득으로 처리되며, 3.3% 원천징수 후 지급됩니다.
2. 종합소득세 신고·납부 의무는 본인에게 있습니다.
3. 국민연금, 건강보험, 고용보험, 장기요양보험(4대 보험)은 본 계약에 따라 적용되지 않습니다.
4. 다만, 산업재해보상보험법 제91조의15 내지 제91조의21(노무제공자 특례)에 따라 산재보험은 별도 적용됩니다. (제11조 참조)

▪ 상호 확인
본 조항은 계약 체결 시점의 실질적 관계를 확인하는 것이며, 향후 법령 변경 또는 실질 관계의 변화에 따라 법적 지위가 달리 판단될 수 있음을 양 당사자 모두 인지합니다. 법적 지위에 대한 다툼이 있는 경우 제15조의 분쟁해결 절차에 따릅니다.`,
    required: true,
  },

  qualificationConfirm: {
    title: '[필수] 제10조: 화물운송자격 확인',
    content: `제10조 (화물운송자격 확인)
본인은 다음 사항을 확인하고 보증합니다.

1. 화물자동차 운수사업법 제8조에 따른 유효한 화물운송종사자격증을 보유하고 있습니다.
2. 자격증 번호 및 유효기간을 정확히 등록하였으며, 플랫폼에서 자격증 사본의 확인이 가능합니다.
3. 자격증이 만료, 취소 또는 정지될 경우 지체 없이(3영업일 이내) 플랫폼에 통보합니다.
4. 자격증 만료·취소·정지 시:
   가. 즉시 신규 오더 수락이 중단됩니다.
   나. 진행 중인 오더에 대해서는 안전하게 완료하거나, 완료가 불가한 경우 회사와 협의하여 처리합니다.
   다. 자격 회복 시까지 플랫폼 이용이 정지됩니다.
5. 허위 자격증 등록 시:
   가. 화물자동차 운수사업법 제70조에 따른 법적 처벌을 받을 수 있습니다.
   나. 회사는 즉시 계약을 해지하고 플랫폼 이용을 영구 제한할 수 있습니다.
   다. 허위 등록으로 인해 발생한 모든 손해에 대해 본인이 배상 책임을 부담합니다.`,
    required: true,
  },

  insuranceConfirm: {
    title: '[필수] 제11조: 보험 가입 확인 및 산재보험 특례',
    content: `제11조 (보험)

▪ 적재물배상책임보험 (화물자동차 운수사업법 제35조)
1. 최대 적재량 5톤 이상 또는 총중량 10톤 이상 차량: 의무 가입
   - 사고 1건당 2천만원 이상 보장하는 보험 또는 공제 가입 필수
2. 5톤 미만 차량: 자발적 가입을 강력히 권장하며, 미가입 시 운송 중 사고에 대한 배상 책임은 전적으로 본인에게 있습니다.
3. 미가입 시 과태료: 화물자동차 1대당 50만원 이하 (화물자동차 운수사업법 제72조)

▪ 산업재해보상보험 (노무제공자 특례)
1. 산업재해보상보험법 제91조의15에 따라, 화물차주는 노무제공자로서 산재보험 당연적용 대상입니다.
2. 보험료 분담 (고용보험 및 산업재해보상보험의 보험료징수 등에 관한 법률 제48조의6제6항):
   - 회사 부담: 50%
   - 헬퍼 부담: 50% (정산 시 원천공제)
3. 보험료 산정: 월 보수액(사업소득 - 경비율 적용) × 해당 연도 고용노동부 고시 직종별 보험료율
4. 원천공제 시 매 정산 건별로 공제내역서를 앱 내에서 확인할 수 있습니다.
5. 매년 3월 31일까지 전년도 보수총액 정산을 실시합니다.
6. 산재보험 적용을 원하지 않는 경우, 산업재해보상보험법에 따라 근로복지공단에 적용제외 신청을 할 수 있습니다.

▪ 자동차보험
1. 헬퍼는 자동차손해배상보장법에 따른 의무보험(대인·대물)에 가입하여야 합니다.
2. 영업용 자동차보험에 가입하여야 하며, 자가용 보험은 인정되지 않습니다.`,
    required: true,
  },

  commissionDeduction: {
    title: '[필수] 제12조: 수수료 및 공제',
    content: `제12조 (수수료 및 공제)
본인은 정산 시 다음 항목이 공제됨을 확인하고 동의합니다.

▪ 플랫폼 수수료
1. 구성: 플랫폼 수수료(platformRate) + 팀장 인센티브(teamLeaderRate)
2. 합산 상한: 정산금액의 30%를 초과할 수 없습니다.
3. 현행 적용 수수료율: 앱 내 "수수료 정책" 메뉴에서 실시간 확인 가능
4. 수수료율 변경: 제16조에 따라 변경 최소 30일 전에 앱 알림 및 문자(SMS)로 사전 고지됩니다.
5. 수수료율 변경에 동의하지 않는 경우, 제14조에 따라 계약을 해지할 수 있습니다.

▪ 산재보험료 원천공제
1. 산재보험료 헬퍼 부담분(50%)이 정산에서 원천공제됩니다.
2. 공제내역서는 매 정산 시 앱 내에서 확인 가능합니다.

▪ 원천징수
1. 사업소득 원천징수세액(3.3%)이 공제됩니다.
2. 원천징수영수증은 매년 3월 앱 내에서 발급 가능합니다.

▪ 손해배상 차감
1. 제8조에 따른 확정된 손해배상액은 헬퍼의 서면 동의를 받아 정산에서 차감할 수 있습니다.
2. 분쟁 중인 손해배상액은 차감하지 않으며, 해당 금액만 보류(hold)됩니다.

▪ 정산 일정
1. 마감 후 익월 내 정산 지급을 원칙으로 합니다.
2. 정산금은 헬퍼가 등록한 본인 명의 은행계좌로 입금됩니다.
3. 공제 항목별 상세 내역은 매 정산 시 앱 내 정산서에서 확인할 수 있습니다.`,
    required: true,
  },

  noRedelegation: {
    title: '[필수] 제13조: 재위탁 금지',
    content: `제13조 (재위탁 금지)
1. 헬퍼는 플랫폼을 통해 위탁받은 화물운송을 제3자에게 재위탁(다단계 주선)할 수 없습니다.
2. 본 조항은 화물자동차 운수사업법 제11조의2(재위탁 금지)에 근거합니다.
3. 재위탁이 확인되는 경우:
   가. 회사는 즉시 해당 오더에 대한 정산을 보류할 수 있습니다.
   나. 반복적 위반 시 계약을 해지하고 플랫폼 이용을 영구 제한할 수 있습니다.
   다. 재위탁으로 인해 발생한 사고·손해에 대한 책임은 전적으로 헬퍼에게 있습니다.
   라. 화물자동차 운수사업법에 따른 행정처분 및 과태료가 부과될 수 있습니다.`,
    required: true,
  },

  terminationClause: {
    title: '[필수] 제14조: 계약 해지',
    content: `제14조 (계약의 해지)

▪ 일반 해지
1. 양 당사자는 30일 전 서면(앱 내 해지 신청, 이메일 등 전자적 방법 포함) 통지로 계약을 해지할 수 있습니다.
2. 해지 통지 후 30일의 유예기간 동안 진행 중인 오더는 정상적으로 수행·정산합니다.

▪ 즉시 해지 (회사에 의한)
3. 다음의 경우 회사는 사전 통지 없이 즉시 계약을 해지할 수 있습니다:
   가. 화물운송자격증 만료, 취소 또는 정지
   나. 관련 법령의 중대한 위반 (음주운전, 무면허 운전, 마약류 관련 위반 등)
   다. 고의적인 화물 파손, 횡령 또는 절취
   라. 허위 정보 등록 (자격증, 보험, 차량정보 등)
   마. 재위탁 금지(제13조) 위반
   바. 12개월 내 5회 이상 귀책 취소 (제6조 제2호 라목)

▪ 즉시 해지 (헬퍼에 의한)
4. 다음의 경우 헬퍼는 사전 통지 없이 즉시 계약을 해지할 수 있습니다:
   가. 회사가 정산금을 30일 이상 지연하는 경우
   나. 회사가 수수료율을 사전 고지 없이 일방적으로 변경한 경우
   다. 회사가 본 계약의 중대한 의무를 위반한 경우

▪ 해지 후 처리
5. 계약 해지 시 이미 수행 완료된 오더에 대한 정산금은 정상적으로 지급합니다.
6. 해지 후에도 미정산 건에 대한 권리·의무는 정산 완료 시까지 존속합니다.
7. 헬퍼의 개인정보는 관련 법령에 따른 보존기간 경과 후 파기합니다.`,
    required: true,
  },

  disputeResolution: {
    title: '[필수] 제15조: 분쟁 해결',
    content: `제15조 (분쟁 해결)

▪ 준거법
1. 본 계약의 해석 및 적용에 관해서는 대한민국 법률을 준거법으로 합니다.

▪ 분쟁해결 절차
2. 본 계약과 관련하여 분쟁이 발생한 경우, 다음의 순서에 따라 해결합니다:
   1단계(플랫폼 내 이의제기): 분쟁 발생일로부터 14일 이내에 앱 내 이의제기 시스템을 통해 접수합니다.
   2단계(당사자 간 협의): 이의제기 접수일로부터 14일 이내에 당사자 간 협의를 시도합니다.
   3단계(외부 조정): 협의가 이루어지지 않는 경우, 대한상사중재원의 조정 또는 한국소비자원의 분쟁조정을 이용할 수 있습니다.
   4단계(소송): 조정이 이루어지지 않는 경우, 관할 법원에 소송을 제기할 수 있습니다.

▪ 관할법원
3. 본 계약에 관한 소송은 회사의 본점 소재지를 관할하는 법원을 제1심 전속관할법원으로 합니다. 다만, 헬퍼가 개인사업자인 경우 민사소송법의 일반 관할 규정에 따릅니다.

▪ 분쟁 중 정산 보류
4. 분쟁 대상 오더의 정산금은 분쟁 해결 시까지 보류(hold)됩니다.
5. 보류된 정산금에 대해서는 분쟁 해결 결과에 따라 지연이자(연 6%, 상법 제54조)를 가산하여 지급합니다.
6. 분쟁과 무관한 다른 오더의 정산은 정상적으로 진행됩니다.`,
    required: true,
  },

  termsChangePolicy: {
    title: '[필수] 제16조: 약관 변경 절차',
    content: `제16조 (약관 변경)

1. 회사는 관련 법령의 변경, 서비스 정책 변경 등의 사유로 본 계약의 내용을 변경할 수 있습니다.
2. 약관 변경 시 다음의 절차를 따릅니다:
   가. 변경 내용, 변경 사유, 시행일을 명시하여 시행일 최소 30일 전에 앱 알림, 문자(SMS), 이메일 중 2개 이상의 방법으로 고지합니다.
   나. 헬퍼에게 불리한 변경의 경우, 시행일 최소 30일 전에 고지하며, 고지 내용에 "동의하지 않을 경우 계약을 해지할 수 있다"는 내용을 포함합니다.
   다. 고지 후 30일 이내에 거부 의사를 표시하지 않으면 변경에 동의한 것으로 봅니다.

3. 약관 변경에 동의하지 않는 헬퍼는 시행일 전까지 계약을 해지할 수 있으며, 이 경우 위약금은 부과되지 않습니다.
4. 변경된 약관은 termsVersions 테이블에 새로운 버전으로 기록되며, 이전 버전도 보존됩니다.
5. 본 조항은 약관의 규제에 관한 법률 제3조(약관의 작성 및 설명의무)에 따릅니다.`,
    required: true,
  },

  electronicContract: {
    title: '[필수] 제17조: 전자계약 및 동의 기록',
    content: `제17조 (전자계약 및 동의 기록)

▪ 전자계약의 효력
1. 앱 내에서 이루어지는 전자적 동의(체크박스 선택 및 전자서명)는 다음 법령에 따라 서면 계약과 동일한 법적 효력을 가집니다:
   - 전자문서 및 전자거래 기본법 제4조(전자문서의 효력)
   - 전자문서 및 전자거래 기본법 제4조의2(전자문서의 서면요건: 열람가능성, 재현가능성, 보존성)
   - 전자서명법 제3조(전자서명의 효력)
2. 각 동의 항목은 반드시 개별적으로 내용을 열람한 후 동의하여야 하며, 일괄 동의만으로는 효력이 발생하지 않습니다.

▪ 감사추적(Audit Trail) 기록
3. 회사는 법적 증빙을 위해 다음 정보를 기록·보관합니다:
   가. 동의한 각 항목의 식별자 및 동의 시각 (초 단위)
   나. 동의 시점의 IP 주소
   다. 사용 기기 정보 (User-Agent)
   라. 동의한 약관 버전 ID
   마. 전자서명 데이터 (서명 좌표, 서명 시각)
4. 위 기록은 계약 종료 후 5년간 보존됩니다(상법 제33조, 전자상거래법 제6조).

▪ 전자적 고지 수단
5. 서비스 관련 고지 및 안내를 앱 알림, 문자(SMS), 이메일 등 전자적 수단으로 수신하는 것에 동의합니다.
6. 계약 변경(제16조), 정산 내역, 중요 공지사항은 전자적 수단으로 통지됩니다.`,
    required: true,
  },

  privacyConsent: {
    title: '[필수] 제18조: 개인정보 수집·이용 동의',
    content: `제18조 (개인정보 수집·이용)

▪ 수집 항목 및 이용 목적 (개인정보보호법 제15조 제1항)

1) 이름, 생년월일, 휴대전화번호
- 목적: 본인 확인 및 헬퍼 자격 검증
- 보유: 탈퇴 후 5년 (상법 제33조)

2) 차량번호, 차량종류, 자격증 정보
- 목적: 오더 매칭, 배차 관리, 운송자격 검증
- 보유: 탈퇴 후 5년

3) 은행명, 계좌번호, 예금주
- 목적: 정산금 지급 처리
- 보유: 탈퇴 후 5년 (전자상거래법 제6조)

4) 위치정보
- 목적: 작업 현장 확인 및 안전관리 (위치정보의 보호 및 이용 등에 관한 법률 제15조)
- 보유: 수집 후 1년

5) 업무 증빙 사진, 운송 로그, QR 체크인 기록
- 목적: 분쟁 대응 및 증빙 관리
- 보유: 오더 완료 후 5년

6) IP 주소, 기기정보, 동의 기록
- 목적: 전자계약 법적 증빙 (전자문서법 제4조의2)
- 보유: 계약 종료 후 5년

▪ 개인정보 제3자 제공 (개인정보보호법 제17조)
- 요청자에게 헬퍼의 이름, 차량번호, 연락처를 오더 수행 목적으로 제공합니다.
- 국세청에 원천징수 관련 정보를 제공합니다.
- 근로복지공단에 산재보험 관련 정보를 제공합니다.

▪ 동의 거부 시
- 필수 항목에 대한 동의를 거부할 경우 서비스 가입이 불가합니다.
- 위치정보 수집 동의를 거부할 경우 일부 기능 이용이 제한될 수 있습니다.

▪ 정보주체의 권리 (개인정보보호법 제35조~제37조)
- 개인정보의 열람, 정정·삭제, 처리정지를 요구할 수 있습니다.
- 요구 방법: 앱 내 "개인정보 관리" 메뉴 또는 고객센터`,
    required: true,
  },

  generalProvisions: {
    title: '[필수] 부칙: 일반 조항',
    content: `부칙

1. (가분성) 본 계약의 일부 조항이 관할 법원 또는 관련 법령에 의해 무효 또는 집행 불능으로 판명되더라도, 나머지 조항의 효력에는 영향을 미치지 않습니다. 무효 조항은 그 취지에 가장 부합하는 유효한 조항으로 대체된 것으로 해석합니다.

2. (완전합의) 본 계약은 본 계약의 대상에 관한 양 당사자 간의 완전한 합의를 구성하며, 이전의 구두 또는 서면 합의를 대체합니다.

3. (권리불포기) 일방 당사자가 본 계약상의 권리를 행사하지 않거나 지연하더라도, 이는 해당 권리의 포기로 해석되지 않습니다.

4. (보충 법령) 본 계약에 명시되지 않은 사항은 화물자동차 운수사업법, 상법, 민법, 전자문서 및 전자거래 기본법, 약관의 규제에 관한 법률, 개인정보보호법 등 관련 법령에 따릅니다.

5. (시행일) 본 계약은 전자적 동의 완료 시점부터 효력이 발생합니다.

6. (약관규제법 준수) 본 계약은 약관의 규제에 관한 법률에 따라 작성되었으며, 동법 제6조(일반원칙)에 따른 신의성실의 원칙을 준수합니다. 동법에 따라 고객에게 부당하게 불리한 조항은 무효입니다.`,
    required: true,
  },

  // ── 선택 동의 항목 ──

  marketingConsent: {
    title: '[선택] 마케팅 정보 수신 동의',
    content: `HellpMe 플랫폼의 새로운 서비스, 이벤트, 프로모션, 할인 정보 등 마케팅 관련 정보를 앱 알림, 문자(SMS), 이메일 등으로 수신하는 것에 동의합니다.

• 본 동의는 선택 사항이며, 동의하지 않아도 서비스 이용에 제한은 없습니다.
• 동의 후에도 앱 설정에서 언제든 수신 거부할 수 있습니다.
• 수신 거부 후에도 거래 관련 필수 통지(정산 내역, 약관 변경 등)는 발송됩니다.`,
    required: false,
  },

  taxInvoiceConsent: {
    title: '[선택] 세금계산서 자동 발행 동의',
    content: `정산 완료 시 전자세금계산서를 자동 발행하는 것에 동의합니다.

• 동의하지 않을 경우 별도 요청이 필요합니다.
• 세금계산서는 등록된 사업자 정보 기준으로 발행됩니다.
• 사업자등록증 정보 변경 시 즉시 플랫폼에 반영하여야 합니다.`,
    required: false,
  },
};

// 헬퍼 계약 체크박스 키 목록 (UI 렌더링용)
export const HELPER_CONTRACT_CHECKBOX_KEYS = {
  required: [
    'contractPurpose',
    'paymentSettlement',
    'cancellationPenalty',
    'helperObligations',
    'independentContractor',
    'qualificationConfirm',
    'insuranceConfirm',
    'commissionDeduction',
    'noRedelegation',
    'terminationClause',
    'disputeResolution',
    'termsChangePolicy',
    'electronicContract',
    'privacyConsent',
    'generalProvisions',
  ] as const,
  optional: [
    'marketingConsent',
    'taxInvoiceConsent',
  ] as const,
};


// ═══════════════════════════════════════════════════════════════
// 2. 요청자(의뢰자) 오더등록 화물운송위탁계약서
//    - 오더 등록시마다 체결
//    - termsType: "requester_order"
//    - 요청자는 사업자(B2B)로 추정, 전자상거래법 제3조에 따라 소비자보호 규정 적용제외
// ═══════════════════════════════════════════════════════════════

export const REQUESTER_ORDER_CONTRACT_TERMS = {
  // ── 전체 계약 개요 (표시용, 체크박스 아님) ──
  contractOverview: {
    title: '오더별 화물운송위탁계약서 (요청자 ↔ 주식회사 헬프미)',
    content: `본 계약은 주식회사 헬프미(사업자등록번호: [사업자번호], 이하 "회사")와 화물운송 위탁자(이하 "요청자") 간에 HellpMe 플랫폼을 통한 개별 오더의 화물운송 위탁에 관하여 체결하는 계약입니다.

본 계약은 각 오더 등록시마다 체결되며, 해당 오더의 작업 완료 및 최종 정산 완료 시까지 유효합니다.

▪ 거래 성격
  본 거래는 사업자 간 상행위(상법 제46조)에 해당하며, 전자상거래 등에서의 소비자보호에 관한 법률 제3조 제1항에 따라 소비자보호 규정(청약철회 등)이 적용되지 않습니다.

▪ 계약 구조
  1. 요청자가 오더를 등록하고 계약금을 납부하면 계약이 성립합니다.
  2. 계약금율은 플랫폼 관리자 설정값(deposit_rate)에 따라 자동 산출됩니다.
  3. 작업 완료 후 실적 기준으로 최종 정산됩니다.`,
  },

  // ── 필수 동의 항목 ──

  orderContractAgree: {
    title: '[필수] 제1조~제2조: 오더 계약 성립 및 효력',
    content: `제1조 (계약의 성립)
1. 본 계약은 요청자가 오더를 등록하고 계약금을 납부한 시점에 성립합니다.
2. 오더 등록 시 기재한 배송지역, 물량, 일정, 단가, 화물 종류, 차량 요건 등의 정보는 계약의 일부를 구성합니다.
3. 등록된 정보가 사실과 다른 경우 이로 인한 책임은 요청자에게 있으며, 이로 인해 헬퍼 또는 회사에 발생한 손해를 배상하여야 합니다.

제2조 (계약의 효력 및 거래 성격)
1. 본 계약은 해당 오더의 작업 완료 및 최종 정산 완료 시까지 유효합니다.
2. 전자적 동의(체크박스 선택)는 전자문서 및 전자거래 기본법 제4조 및 제4조의2에 따라 서면 계약과 동일한 법적 효력을 가집니다.
3. 요청자는 본 거래가 사업 목적의 상행위(상법 제46조)임을 확인합니다. 따라서 전자상거래 등에서의 소비자보호에 관한 법률 제3조 제1항에 따라 청약철회 등 소비자보호 규정은 적용되지 않으며, 본 계약 및 상법·민법의 일반 법리에 따릅니다.
4. 요청자가 사업자등록증을 보유한 법인 또는 개인사업자임을 확인합니다.`,
    required: true,
  },

  depositPaymentAgree: {
    title: '[필수] 제3조: 계약금 결제',
    content: `제3조 (계약금)
본인은 오더 등록 시 계약금을 납부하는 것에 동의합니다.

▪ 계약금 산출 방식
  공급가액 = 예상 BOX수 × 단가(원/BOX)
  부가세 = 공급가액 × 10%
  합계(부가세 포함) = 공급가액 × 1.1
  계약금 = 합계 × 계약금율(%)
  ※ 계약금율: 플랫폼 관리자 설정값(deposit_rate)에 의해 자동 적용 (현행 기본값: 10%)
  ※ 계약금율 변경 시 제9조에 따라 사전 고지됩니다.

▪ 계약금의 법적 성격
  1. 계약금은 민법 제565조에 따른 해약금의 성격이 아닌, 오더 이행 보증금(선급금)입니다.
  2. 정상 거래 완료 시 총 대금에서 차감됩니다.
  3. 계약금 납부 완료 시 오더가 헬퍼에게 공개되어 매칭이 시작됩니다.
  4. 계약금 미납 시 오더는 "대기" 상태로 유지되며 매칭되지 않습니다.

▪ 결제 수단
  플랫폼이 제공하는 결제 방법(가상계좌 이체, 카드 결제 등)을 이용합니다.`,
    required: true,
  },

  balanceSettlementAgree: {
    title: '[필수] 제4조: 잔금 결제 및 정산',
    content: `제4조 (잔금 및 정산)
본인은 작업 완료 후 잔금을 정해진 기한 내에 납부하는 것에 동의합니다.

▪ 정산 절차
1. 헬퍼가 마감보고서(배송수량, 회수수량, 픽업수량 등)를 제출합니다.
2. 요청자는 마감보고서를 확인하고 3영업일 이내에 승인 또는 이의를 제기합니다.
3. 승인 시 최종 금액이 확정되며, 잔금(총액 - 계약금)을 정해진 기한 내에 납부합니다.
4. 3영업일 이내에 이의제기 또는 승인이 없는 경우, 마감보고서 기준으로 자동 확정됩니다. 자동 확정에 대해 이의가 있는 경우 확정일로부터 7일 이내에 제8조의 분쟁해결 절차를 이용할 수 있습니다.

▪ 잔금 납부 기한
  최종 금액 확정일로부터 7영업일 이내
  기한 초과 시 연 6%의 지연이자가 부과됩니다(상법 제54조).

▪ 세금계산서
  정산 완료 시 전자세금계산서가 발행됩니다.
  세금계산서 발행 시기: 공급일이 속하는 달의 다음달 10일까지 (부가가치세법 제34조)`,
    required: true,
  },

  cancellationRefundAgree: {
    title: '[필수] 제5조: 취소 및 대금 반환',
    content: `제5조 (취소 및 대금 반환)
본인은 다음의 취소 및 대금 반환 정책에 동의합니다.

▪ 요청자에 의한 취소
1. 오더 매칭 전: 계약금 전액 반환 (위약금 없음)
2. 매칭 후 ~ 작업개시 24시간 전: 계약금의 90% 반환, 10%는 헬퍼 손해보전금으로 지급
3. 작업개시 24시간 이내 ~ 작업 시작 후: 계약금 반환 불가, 헬퍼에게 발생한 실제 손해 별도 배상

▪ 헬퍼 귀책에 의한 취소
4. 계약금은 요청자에게 전액 반환됩니다.
5. 요청자에게 발생한 직접 손해(대체 운송비 차액, 긴급 배차 비용 등)는 헬퍼가 배상합니다.

▪ 불가항력에 의한 취소
6. 천재지변, 전쟁, 전염병, 정부 명령 등 불가항력 사유에 의한 취소 시, 양 당사자 모두 위약금 책임을 면하며 계약금은 전액 반환됩니다.

▪ 환불 처리
7. 환불은 원 결제 수단과 동일한 방법으로 5영업일 내 처리됩니다.
8. 부분 취소의 경우, 실제 수행된 부분의 대금을 정산한 후 차액을 반환합니다.

▪ 본 거래의 성격 (B2B 확인)
9. 본 조항은 사업자 간 상행위에 적용되는 계약 해제·해지 법리에 따릅니다. 전자상거래법상 소비자 청약철회(7일 이내 무조건 철회) 규정은 본 거래에 적용되지 않습니다(전자상거래법 제3조 제1항).`,
    required: true,
  },

  requesterObligations: {
    title: '[필수] 제6조: 요청자 의무',
    content: `제6조 (요청자의 의무)

▪ 정보 제공 의무
1. 오더 등록 시 정확한 배송지역, 물량, 일정, 입차시간, 화물 종류 등을 기재하여야 합니다.
2. 허위 또는 부정확한 정보 등록으로 인한 손해(헬퍼 손해 포함)는 요청자가 배상합니다.
3. 헬퍼의 작업 수행에 필요한 자료(배송지도, 배송가이드, 캠프주소, 담당자 연락처 등)를 제공하여야 합니다.
4. 필요 자료 미제공으로 인한 배송 지연·오류는 요청자 귀책으로 처리됩니다.

▪ 대금 납부 의무
5. 계약금 및 잔금을 정해진 기한 내에 납부하여야 합니다.
6. 잔금 미납 시: 납부 기한 경과 후 연 6% 지연이자 부과(상법 제54조)
7. 30일 이상 대금 미납 시: 플랫폼 이용이 제한되며, 법적 조치(지급명령 등)가 진행될 수 있습니다.

▪ 마감보고서 확인 의무
8. 헬퍼가 제출한 마감보고서를 3영업일 이내에 확인하여야 합니다.
9. 기한 내 미확인 시 마감보고서 기준으로 자동 확정됩니다.

▪ 화물 가액 신고 의무
10. 오더 등록 시 화물의 대략적 가액을 신고하여야 합니다.
11. 미신고 시 화물 파손/분실에 대한 배상 상한은 해당 오더 운송대금의 3배 또는 500만원 중 적은 금액으로 제한됩니다.

▪ 안전 관련 의무
12. 위험물, 귀중품 등 특수 화물의 경우 반드시 사전에 고지하여야 합니다.
13. 미고지로 인한 사고 시 전적으로 요청자의 책임입니다.`,
    required: true,
  },

  platformLiability: {
    title: '[필수] 제7조: 플랫폼 역할 및 책임 범위',
    content: `제7조 (플랫폼의 역할 및 책임)

▪ 플랫폼의 역할
1. HellpMe는 화물자동차 운수사업법에 따른 화물운송 중개 플랫폼으로서, 요청자와 헬퍼 간의 운송 거래를 중개합니다.
2. 회사는 운송 자체의 당사자가 아니며, 화물의 직접적인 운송 책임을 부담하지 않습니다.

▪ 회사의 의무 (면책의 제한)
3. 회사는 다음의 의무를 부담합니다:
   가. 결제 대금의 안전한 보관 및 적시 정산 (선관주의 의무)
   나. 헬퍼의 자격증 및 보험 유효성 확인 (등록 시 및 주기적 갱신 확인)
   다. 분쟁 발생 시 중재 절차 제공
   라. 플랫폼의 안정적 운영 및 보안 유지
   마. 약관 변경 시 사전 고지 의무 이행
   바. 개인정보의 안전한 관리

▪ 책임 제한
4. 다음 사항에 대해 회사는 직접적 책임을 부담하지 않습니다:
   가. 운송 과정에서 헬퍼의 과실로 인한 화물 파손·분실·훼손 (단, 헬퍼 자격 미확인 등 회사의 확인 의무 해태가 있는 경우는 제외)
   나. 배송 지연 또는 오배송 (단, 플랫폼 시스템 오류로 인한 경우는 제외)
   다. 불가항력으로 인한 서비스 중단 (단, 합리적 범위 내에서 서비스 복구를 위해 노력합니다)

5. 본 조의 면책 범위는 약관의 규제에 관한 법률 제7조(면책조항의 금지)에 따라, 회사의 고의 또는 중대한 과실로 인한 손해에 대해서는 적용되지 않습니다.`,
    required: true,
  },

  disputeAndJurisdiction: {
    title: '[필수] 제8조: 분쟁 해결 및 관할',
    content: `제8조 (분쟁 해결)

▪ 준거법
1. 본 계약의 해석 및 적용은 대한민국 법률에 따릅니다.

▪ 분쟁해결 절차
2. 본 계약 관련 분쟁 발생 시:
   1단계: 앱 내 이의제기 접수 (마감보고서 자동확정 후 7일 이내, 기타 분쟁 14일 이내)
   2단계: 당사자 간 협의 (접수 후 14일 이내)
   3단계: 외부 조정 (대한상사중재원 조정 또는 관할 지방자치단체 분쟁조정위원회)
   4단계: 관할 법원 소송

▪ 관할법원
3. 본 계약에 관한 소송은 회사의 본점 소재지를 관할하는 법원을 제1심 전속관할법원으로 합니다.

▪ 분쟁 중 정산 처리
4. 분쟁 대상 금액은 분쟁 해결 시까지 보류(hold)됩니다.
5. 분쟁과 무관한 정산 건은 정상 처리됩니다.
6. 보류된 금액에 대해 분쟁 결과에 따라 지연이자(연 6%)가 가산될 수 있습니다.`,
    required: true,
  },

  termsChangeAndGeneral: {
    title: '[필수] 제9조~제10조: 약관 변경 및 일반 조항',
    content: `제9조 (약관 변경)
1. 회사는 관련 법령 변경, 서비스 정책 변경 등의 사유로 본 계약 내용을 변경할 수 있습니다.
2. 변경 시 시행일 최소 30일 전에 앱 알림 및 문자(SMS)로 변경 내용, 사유, 시행일을 고지합니다.
3. 요청자에게 불리한 변경 시, "동의하지 않을 경우 오더 등록을 중단할 수 있다"는 안내를 포함합니다.
4. 변경 약관은 변경 시행일 이후 신규 등록 오더부터 적용됩니다. 이미 등록된 오더에는 등록 시점의 약관이 적용됩니다.

제10조 (일반 조항)
1. (가분성) 본 계약의 일부 조항이 무효로 판명되더라도 나머지 조항의 효력에는 영향을 미치지 않습니다.
2. (보충 법령) 본 계약에 명시되지 않은 사항은 화물자동차 운수사업법, 상법, 민법 등에 따릅니다.
3. (약관규제법 준수) 본 계약은 약관의 규제에 관한 법률에 따라 작성되었으며, 고객에게 부당하게 불리한 조항은 동법에 의해 무효입니다.
4. (동의 기록) 동의 내역은 IP 주소, 동의 시각, 기기 정보, 약관 버전과 함께 5년간 기록·보관됩니다(전자문서법 제4조의2, 상법 제33조).`,
    required: true,
  },

  electronicSignature: {
    title: '[필수] 전자서명 및 전자계약 동의',
    content: `본인은 다음 사항에 동의합니다.

1. 본 오더 등록에 따른 전자적 동의(체크박스 개별 선택, 전자서명)가 서면 계약과 동일한 법적 효력을 가짐을 확인합니다.
2. 법적 근거:
   - 전자문서 및 전자거래 기본법 제4조(전자문서의 효력)
   - 전자문서 및 전자거래 기본법 제4조의2(서면요건: 열람가능성, 재현가능성, 보존성)
   - 전자서명법 제3조(전자서명의 효력)
3. 각 동의 항목은 개별적으로 내용을 열람한 후 동의합니다. 일괄 동의만으로는 효력이 발생하지 않습니다.
4. 동의 기록(동의 항목, 시각, IP, 기기정보, 약관 버전)은 법적 증빙을 위해 오더 완료 후 5년간 보관됩니다.`,
    required: true,
  },

  privacyForOrder: {
    title: '[필수] 개인정보 수집·이용 동의 (오더용)',
    content: `본 오더 처리를 위해 다음 개인정보를 수집·이용하는 것에 동의합니다.

▪ 수집 항목 및 이용 목적

1) 상호/성명, 사업자등록번호, 연락처, 이메일
- 목적: 요청자 확인, 세금계산서 발행
- 보유: 오더 완료 후 5년 (상법)

2) 배송지역, 물량, 일정, 캠프주소, 담당자 연락처
- 목적: 오더 등록 및 헬퍼 매칭
- 보유: 오더 완료 후 5년

3) 결제 수단, 결제 내역
- 목적: 계약금/잔금 결제 처리
- 보유: 오더 완료 후 5년 (전상법)

▪ 개인정보 제3자 제공 (개인정보보호법 제17조)
  - 매칭된 헬퍼에게 배송지역, 캠프주소, 담당자 연락처를 오더 수행 목적으로 제공합니다.
  - 국세청에 세금계산서 발행 관련 정보를 제공합니다.

▪ 동의 거부 시
  필수 항목에 대한 동의를 거부할 경우 오더 등록이 불가합니다.

▪ 정보주체의 권리 (개인정보보호법 제35조~제37조)
  개인정보의 열람, 정정·삭제, 처리정지를 요구할 수 있습니다.
  요구 방법: 앱 내 "개인정보 관리" 메뉴 또는 고객센터

(개인정보보호법 제15조, 제17조, 제22조에 근거)`,
    required: true,
  },

  // ── 선택 동의 항목 ──

  marketingConsent: {
    title: '[선택] 마케팅 정보 수신 동의',
    content: `HellpMe 플랫폼의 새로운 서비스, 이벤트, 프로모션 등의 마케팅 정보를 수신하는 것에 동의합니다.

• 동의하지 않아도 서비스 이용에 제한은 없습니다.
• 동의 후에도 앱 설정에서 언제든 수신 거부할 수 있습니다.`,
    required: false,
  },

  autoTaxInvoice: {
    title: '[선택] 세금계산서 자동 발행 요청',
    content: `본 오더 정산 완료 시 전자세금계산서를 자동 발행하는 것에 동의합니다.

• 등록된 사업자 정보 기준으로 발행됩니다.
• 동의하지 않을 경우 별도 요청이 필요합니다.
• 사업자등록 정보 변경 시 즉시 반영하여야 합니다.`,
    required: false,
  },
};

// 요청자 오더 계약 체크박스 키 목록 (UI 렌더링용)
export const REQUESTER_ORDER_CHECKBOX_KEYS = {
  required: [
    'orderContractAgree',
    'depositPaymentAgree',
    'balanceSettlementAgree',
    'cancellationRefundAgree',
    'requesterObligations',
    'platformLiability',
    'disputeAndJurisdiction',
    'termsChangeAndGeneral',
    'electronicSignature',
    'privacyForOrder',
  ] as const,
  optional: [
    'marketingConsent',
    'autoTaxInvoice',
  ] as const,
};


// ═══════════════════════════════════════════════════════════════
// 타입 정의
// ═══════════════════════════════════════════════════════════════

export type HelperContractKey = keyof typeof HELPER_CONTRACT_TERMS;
export type RequesterOrderContractKey = keyof typeof REQUESTER_ORDER_CONTRACT_TERMS;

export interface ContractCheckboxState {
  [key: string]: boolean;
}

// 헬퍼 계약 초기 체크박스 상태 생성
export function createHelperContractState(): ContractCheckboxState {
  const state: ContractCheckboxState = { all: false };
  [...HELPER_CONTRACT_CHECKBOX_KEYS.required, ...HELPER_CONTRACT_CHECKBOX_KEYS.optional].forEach(key => {
    state[key] = false;
  });
  return state;
}

// 요청자 오더계약 초기 체크박스 상태 생성
export function createRequesterOrderContractState(): ContractCheckboxState {
  const state: ContractCheckboxState = { all: false };
  [...REQUESTER_ORDER_CHECKBOX_KEYS.required, ...REQUESTER_ORDER_CHECKBOX_KEYS.optional].forEach(key => {
    state[key] = false;
  });
  return state;
}

// 필수 항목 전체 동의 여부 확인
export function isAllRequiredAgreed(
  state: ContractCheckboxState,
  keys: readonly string[]
): boolean {
  return keys.every(key => state[key] === true);
}

// 개별 항목 열람 여부 추적 (법적 방어용 - 열람 없이 동의 방지)
export interface ContractReadState {
  [key: string]: boolean;
}

export function createHelperContractReadState(): ContractReadState {
  const state: ContractReadState = {};
  [...HELPER_CONTRACT_CHECKBOX_KEYS.required, ...HELPER_CONTRACT_CHECKBOX_KEYS.optional].forEach(key => {
    state[key] = false;
  });
  return state;
}

export function createRequesterOrderContractReadState(): ContractReadState {
  const state: ContractReadState = {};
  [...REQUESTER_ORDER_CHECKBOX_KEYS.required, ...REQUESTER_ORDER_CHECKBOX_KEYS.optional].forEach(key => {
    state[key] = false;
  });
  return state;
}

// 열람하지 않은 항목에 동의할 수 없도록 검증
export function canAgreeToItem(
  readState: ContractReadState,
  key: string
): boolean {
  return readState[key] === true;
}

// 동의 기록 생성 (감사추적용)
export interface ConsentAuditRecord {
  itemKey: string;
  agreedAt: string; // ISO 8601
  readAt: string; // ISO 8601 - 열람 시각
  ipAddress?: string;
  userAgent?: string;
  termsVersion: string;
}

export function createConsentAuditRecord(
  itemKey: string,
  readAt: Date,
  termsVersion: string
): ConsentAuditRecord {
  return {
    itemKey,
    agreedAt: new Date().toISOString(),
    readAt: readAt.toISOString(),
    termsVersion,
  };
}

// ═══════════════════════════════════════════════════════════════
// 동적 설정값 기반 계약서 생성 함수
// 관리자 설정이 변경되면 계약서 텍스트에 자동 반영됩니다.
// ═══════════════════════════════════════════════════════════════

export interface ContractSettings {
  depositRate: number;           // 계약금율 (%) — 기본 10
  commissionRateMax: number;     // 수수료 상한 (%) — 기본 30
  refundBeforeMatching: number;  // 매칭 전 환불율 (%) — 기본 100
  refundAfterMatching: number;   // 매칭 후 환불율 (%) — 기본 90
  platformFeeRate: number;       // 플랫폼 수수료율 (%) — 기본 8
}

export const DEFAULT_CONTRACT_SETTINGS: ContractSettings = {
  depositRate: 10,
  commissionRateMax: 30,
  refundBeforeMatching: 100,
  refundAfterMatching: 90,
  platformFeeRate: 8,
};

/**
 * 설정값 기반 텍스트 치환 유틸
 * 계약서 내 하드코딩된 비율/퍼센트를 동적 값으로 교체
 */
function applySettingsToContent(content: string, s: ContractSettings): string {
  return content
    // 계약금율 기본값
    .replace(/계약금율의 현행 기본값은 10%/g, `계약금율의 현행 기본값은 ${s.depositRate}%`)
    .replace(/계약금율 현행 기본값: 10%/g, `계약금율 현행 기본값: ${s.depositRate}%`)
    .replace(/현행 기본값: 10%\)/g, `현행 기본값: ${s.depositRate}%)`)
    // 수수료 상한
    .replace(/최대 30%를 초과할 수 없습니다/g, `최대 ${s.commissionRateMax}%를 초과할 수 없습니다`)
    .replace(/정산금액의 30%를 초과할 수 없습니다/g, `정산금액의 ${s.commissionRateMax}%를 초과할 수 없습니다`)
    // 매칭 후 환불율
    .replace(/계약금의 90% 반환, 10%는 위약금/g,
      `계약금의 ${s.refundAfterMatching}% 반환, ${100 - s.refundAfterMatching}%는 위약금`)
    .replace(/계약금의 90% 반환, 10%는 헬퍼 손해보전금/g,
      `계약금의 ${s.refundAfterMatching}% 반환, ${100 - s.refundAfterMatching}%는 헬퍼 손해보전금`);
}

function applySettingsToTerms<T extends Record<string, any>>(terms: T, s: ContractSettings): T {
  const result = { ...terms };
  for (const key of Object.keys(result)) {
    if (result[key] && typeof result[key] === 'object' && 'content' in result[key]) {
      result[key] = {
        ...result[key],
        content: applySettingsToContent(result[key].content, s),
      };
    }
  }
  return result;
}

/**
 * 동적 설정값이 반영된 헬퍼 계약서 반환
 */
export function getHelperContractTerms(settings?: Partial<ContractSettings>) {
  const s = { ...DEFAULT_CONTRACT_SETTINGS, ...settings };
  return applySettingsToTerms(HELPER_CONTRACT_TERMS, s);
}

/**
 * 동적 설정값이 반영된 요청자 오더 계약서 반환
 */
export function getRequesterContractTerms(settings?: Partial<ContractSettings>) {
  const s = { ...DEFAULT_CONTRACT_SETTINGS, ...settings };
  return applySettingsToTerms(REQUESTER_ORDER_CONTRACT_TERMS, s);
}
